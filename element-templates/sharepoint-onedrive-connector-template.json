{
  "$schema": "https://unpkg.com/@camunda/zeebe-element-templates-json-schema/resources/schema.json",
  "name": "SharePoint / OneDrive Connector Template",
  "id": "sharepoint-onedrive-connector",
  "version": 1,
  "description": "Invoke SharePoint and OneDrive operations via the Microsoft Graph API",
  "icon": {
    "contents": "data:image/png;base64,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"
  },
  "documentationRef": "https://github.com/BP3/sharepoint-connector",
  "category": {
    "id": "connectors",
    "name": "Connectors"
  },
  "appliesTo": [
    "bpmn:Task",
    "bpmn:ServiceTask"
  ],
  "elementType": {
    "value": "bpmn:ServiceTask"
  },
  "groups": [
    {
      "id": "authentication",
      "label": "Authentication"
    },
    {
      "id": "sharePointOperation",
      "label": "SharePoint Operation"
    },
    {
      "id": "timeout",
      "label": "Connect timeout"
    },
    {
      "id": "output",
      "label": "Response mapping"
    },
    {
      "id": "errors",
      "label": "Error handling"
    }
  ],
  "properties": [
    {
      "type": "Hidden",
      "value": "io.camunda:http-json:1",
      "binding": {
        "type": "zeebe:taskDefinition:type"
      }
    },
    {
      "id": "authenticationType",
      "label": "Type",
      "group": "authentication",
      "type": "Dropdown",
      "value": "oauth-client-credentials-flow",
      "choices": [
        {
          "name": "OAuth 2.0",
          "value": "oauth-client-credentials-flow"
        },
        {
          "name": "Bearer token",
          "value": "bearer"
        }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.type"
      }
    },
    {
      "label": "OAuth token endpoint",
      "description": "The OAuth token endpoint",
      "group": "authentication",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.oauthTokenEndpoint"
      },
      "constraints": {
        "notEmpty": true
      },
      "condition": {
        "property": "authenticationType",
        "equals": "oauth-client-credentials-flow"
      }
    },
    {
      "label": "Client ID",
      "description": "Your application's client ID from the OAuth client",
      "group": "authentication",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.clientId"
      },
      "constraints": {
        "notEmpty": true
      },
      "condition": {
        "property": "authenticationType",
        "equals": "oauth-client-credentials-flow"
      }
    },
    {
      "label": "Client secret",
      "description": "Your application's client secret from the OAuth client",
      "group": "authentication",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.clientSecret"
      },
      "constraints": {
        "notEmpty": true
      },
      "condition": {
        "property": "authenticationType",
        "equals": "oauth-client-credentials-flow"
      }
    },
    {
      "label": "Scopes",
      "description": "The scopes which you want to request authorization for (e.g.read:contacts)",
      "group": "authentication",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.scopes"
      },
      "constraints": {
        "notEmpty": true
      },
      "condition": {
        "property": "authenticationType",
        "equals": "oauth-client-credentials-flow"
      }
    },
    {
      "label": "Client authentication",
      "id": "authenticationType",
      "group": "authentication",
      "description": "Send client ID and client secret as Basic Auth request in the header, or as client credentials in the request body",
      "value": "basicAuthHeader",
      "type": "Dropdown",
      "choices": [
        {
          "name": "Send client credentials in body",
          "value": "credentialsBody"
        },
        {
          "name": "Send as Basic Auth header",
          "value": "basicAuthHeader"
        }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.clientAuthentication"
      },
      "condition": {
        "property": "authenticationType",
        "equals": "oauth-client-credentials-flow"
      }
    },
    {
      "label": "Bearer token",
      "group": "authentication",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.token"
      },
      "constraints": {
        "notEmpty": true
      },
      "condition": {
        "property": "authenticationType",
        "equals": "bearer"
      }
    },
    {
      "label": "SharePoint Operation",
      "id": "sharePointOperation",
      "description": "The operation in SharePoint to invoke",
      "group": "sharePointOperation",
      "type": "Dropdown",
      "choices": [
        {
          "name": "Create Folder",
          "value": "createFolder"
        },
        {
          "name": "Get Root Site",
          "value": "getRootSite"
        },
        {
          "name": "List Children",
          "value": "listChildren"
        },
        {
          "name": "Check In",
          "value": "checkIn"
        },
        {
          "name": "Check Out",
          "value": "checkOut"
        },
        {
          "name": "Delete Item",
          "value": "deleteItem"
        },
        {
          "name": "Update Item",
          "value": "updateItem"
        },
        {
          "name": "Move Item",
          "value": "moveItem"
        },
        {
          "name": "Copy Item",
          "value": "copyItem"
        },
        {
          "name": "Search Item",
          "value": "searchItem"
        }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "sharePointOperation"
      }
    },
    {
      "description": "This sets the HTTP method to GET based on the SP operation that is set",
      "id": "getMethod",
      "type": "Hidden",
      "value": "get",
      "condition": {
        "oneOf": [
          "getRootSite",
          "listChildren",
          "searchItem"
        ],
        "property": "sharePointOperation"
      },
      "binding": {
        "type": "zeebe:input",
        "name": "method"
      }
    },
    {
      "description": "This sets the HTTP method to POST based on the SP operation that is set",
      "id": "postMethod",
      "type": "Hidden",
      "value": "post",
      "condition": {
        "oneOf": [
          "createFolder",
          "checkIn",
          "checkOut",
          "copyItem"
        ],
        "property": "sharePointOperation"
      },
      "binding": {
        "type": "zeebe:input",
        "name": "method"
      }
    },
    {
      "description": "This sets the HTTP method to DELETE based on the SP operation that is set",
      "id": "deleteMethod",
      "type": "Hidden",
      "value": "delete",
      "condition": {
        "oneOf": [
          "deleteItem"
        ],
        "property": "sharePointOperation"
      },
      "binding": {
        "type": "zeebe:input",
        "name": "method"
      }
    },
    {
      "description": "This sets the HTTP method to PATCH based on the SP operation that is set",
      "id": "patchMethod",
      "type": "Hidden",
      "value": "patch",
      "condition": {
        "oneOf": [
          "updateItem",
          "moveItem"
        ],
        "property": "sharePointOperation"
      },
      "binding": {
        "type": "zeebe:input",
        "name": "method"
      }
    },
    {
      "description": "This is the Id of the Share Point / One Drive site.",
      "label": "Site Id",
      "group": "sharePointOperation",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "siteId"
      },
      "condition": {
        "oneOf": [
          "createFolder",
          "listChildren",
          "checkIn",
          "checkOut",
          "deleteItem",
          "updateItem",
          "moveItem",
          "copyItem",
          "searchItem"
        ],
        "property": "sharePointOperation"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "description": "This is the Id of the parent item the object will reside in, for example a folder is created inside the parent for this item Id.",
      "label": "Parent Item Id",
      "group": "sharePointOperation",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "parentItemId"
      },
      "condition": {
        "oneOf": [
          "createFolder",
          "listChildren"
        ],
        "property": "sharePointOperation"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "description": "This is the Id of the item that needs to be checked in or checked out or deleted or moved or copied.",
      "label": "Item Id",
      "group": "sharePointOperation",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "itemId"
      },
      "condition": {
        "oneOf": [
          "checkIn",
          "checkOut",
          "deleteItem",
          "updateItem",
          "moveItem",
          "copyItem"
        ],
        "property": "sharePointOperation"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "description": "This is to specify conflict behavior when item is copied.",
      "label": "Conflict Behavior",
      "group": "sharePointOperation",
      "type": "Dropdown",
      "choices": [
        {
          "name": "fail",
          "value": "fail"
        },
        {
          "name": "rename",
          "value": "rename"
        },
        {
          "name": "replace",
          "value": "replace"
        }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "conflictBehavior"
      },
      "condition": {
        "oneOf": [
          "copyItem"
        ],
        "property": "sharePointOperation"
      },
      "constraints": {
        "notEmpty": false
      },
      "value": "fail"
    },
    {
      "description": "The query text used to search for items. Values may be matched across several fields including filename, metadata, and file content.",
      "label": "Search Text",
      "group": "sharePointOperation",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "searchText"
      },
      "condition": {
        "oneOf": [
          "searchItem"
        ],
        "property": "sharePointOperation"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "folderURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+siteId+\"/drive/items/\"+parentItemId+\"/children/\"",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "oneOf": [
          "createFolder",
          "listChildren"
        ],
        "property": "sharePointOperation"
      }
    },
    {
      "id": "getRootSiteURL",
      "type": "Hidden",
      "value": "https://graph.microsoft.com/v1.0/sites/root",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "equals": "getRootSite"
      }
    },
    {
      "id": "checkInURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+siteId+\"/drive/items/\"+itemId+\"/checkin/\"",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "equals": "checkIn"
      }
    },
    {
      "id": "checkOutURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+siteId+\"/drive/items/\"+itemId+\"/checkout/\"",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "equals": "checkOut"
      }
    },
    {
      "id": "deleteUpdateMoveItemURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+siteId+\"/drive/items/\"+itemId+\"\"",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "oneOf": [
          "deleteItem",
          "updateItem",
          "moveItem"
        ]
      }
    },
    {
      "id": "copyItemURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+siteId+\"/drive/items/\"+itemId+\"/copy?@microsoft.graph.conflictBehavior=\"+conflictBehavior",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "equals": "copyItem"
      }
    },
    {
      "id": "searchItemURL",
      "type": "Hidden",
      "value": "=\"https://graph.microsoft.com/v1.0/sites/\"+string(siteId)+\"/drive/root/search(q='\"+searchText+\"')\"",
      "binding": {
        "type": "zeebe:input",
        "name": "url"
      },
      "condition": {
        "property": "sharePointOperation",
        "equals": "searchItem"
      }
    },
    {
      "label": "Request body",
      "description": "Payload to send with the request",
      "group": "sharePointOperation",
      "type": "Text",
      "feel": "optional",
      "value": "={\n\t\"name\":\"My Folder\",\n\t\"folder\": {},\n\t\"@microsoft.graph.conflictBehavior\": \"rename\"\n}",
      "binding": {
        "type": "zeebe:input",
        "name": "body"
      },
      "condition": {
        "property": "sharePointOperation",
        "oneOf": [
          "createFolder"
        ]
      }
    },
    {
      "label": "Request body",
      "description": "Payload to send with the request",
      "group": "sharePointOperation",
      "type": "Text",
      "feel": "optional",
      "value": "={\n\t\"name\":\"My Folder\",\n\t\"@microsoft.graph.conflictBehavior\": \"rename\"\n}",
      "binding": {
        "type": "zeebe:input",
        "name": "body"
      },
      "condition": {
        "property": "sharePointOperation",
        "oneOf": [
          "updateItem"
        ]
      }
    },
    {
      "label": "Request body",
      "description": "Payload to send with the move item request",
      "group": "sharePointOperation",
      "type": "Text",
      "feel": "optional",
      "value": "={\n\t\"parentReference\":{\n\t\t\"id\": \"newParentFolderId\"\n\t},\n\t\"name\": \"new-item-name.txt\"\n}",
      "binding": {
        "type": "zeebe:input",
        "name": "body"
      },
      "condition": {
        "property": "sharePointOperation",
        "oneOf": [
          "moveItem"
        ]
      }
    },
    {
      "label": "Request body",
      "description": "Payload to send with the copy item request",
      "group": "sharePointOperation",
      "type": "Text",
      "feel": "optional",
      "value": "={\n\t\"parentReference\":{\n\t\t\"id\": \"newParentFolderId\",\n\t\t\"driveId\": \"newParentDriveId\"\n\t},\n\t\"name\": \"new-item-name.txt\"\n}",
      "binding": {
        "type": "zeebe:input",
        "name": "body"
      },
      "condition": {
        "property": "sharePointOperation",
        "oneOf": [
          "copyItem"
        ]
      }
    },
    {
      "type": "Hidden",
      "value": "={\"Accept\": \"application/json\",\"Content-Type\": \"application/json\"}",
      "binding": {
        "type": "zeebe:input",
        "name": "headers"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Connection timeout",
      "description": "Sets the timeout in seconds to establish a connection or 0 for an infinite timeout",
      "group": "timeout",
      "type": "String",
      "value": "20",
      "binding": {
        "type": "zeebe:input",
        "name": "connectionTimeoutInSeconds"
      },
      "optional": true,
      "feel": "optional",
      "constraints": {
        "notEmpty": false,
        "pattern": {
          "value": "^(=.+|[0-9]+|\\{\\{secrets\\..+\\}\\})$",
          "message": "Must be a timeout in seconds (default value is 20 seconds) or a FEEL expression"
        }
      }
    },
    {
      "label": "Result variable",
      "description": "Name of variable to store the response in. Details in the <a href=\"https://docs.camunda.io/docs/components/connectors/use-connectors/#result-variable\" target=\"_blank\">documentation</a>",
      "group": "output",
      "type": "String",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "resultVariable"
      }
    },
    {
      "label": "Result expression",
      "description": "Expression to map the response into process variables. Details in the <a href=\"https://docs.camunda.io/docs/components/connectors/use-connectors/#result-expression\" target=\"_blank\">documentation</a>",
      "group": "output",
      "type": "Text",
      "feel": "required",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "resultExpression"
      }
    },
    {
      "label": "Error expression",
      "description": "Expression to handle errors. Details in the <a href=\"https://docs.camunda.io/docs/components/connectors/use-connectors/#bpmn-errors\" target=\"_blank\">documentation</a>",
      "group": "errors",
      "type": "Text",
      "feel": "required",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "errorExpression"
      }
    }
  ]
}
